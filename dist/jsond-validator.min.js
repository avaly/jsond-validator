!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t["jsond-validator"]=e()}(this,function(){"use strict";function t(t,e){return"boolean"!=typeof t?[{code:"BOOLEAN_REQUIRED",path:[].concat(e)}]:[]}function e(t,e){return"string"!=typeof t?[{code:"STRING_REQUIRED",path:[].concat(e)}]:[]}function n(t,e){return"number"!=typeof t?[{code:"NUMBER_REQUIRED",path:[].concat(e)}]:[]}function r(t,e){return"number"!=typeof t||t<0||t%1!=0?[{code:"INTEGER_REQUIRED",path:[].concat(e)}]:[]}function a(t,e,n){var r;return r=e.match(l),r?o(t,e,r,n):(r=e.match(R),r?c(t,e,r,n):i(t,e,n))}function o(t,e,r,a){var o,c=r[1].split(","),i=String(t);return o=n(t),o.length||-1!==c.indexOf(i)||(o=[{code:"NOT_IN_SET",path:[].concat(a)}]),o}function c(t,e,r,a){var o,c,i,h="["===r[1],u="]"===r[4];return i=n(t),!i.length&&r[2]&&r[2].length&&(o=Number(r[2]),!1,(h?t>=o:t>o)||(i=[{code:"INTERVAL_START",path:[].concat(a)}])),!i.length&&r[3]&&r[3].length&&(c=Number(r[3]),!1,(u?t<=c:t<c)||(i=[{code:"INTERVAL_END",path:[].concat(a)}])),i}function i(t,e,n){var r;return"^"!==e[0]&&(e="^"+e),"$"!==e[e.length-1]&&(e+="$"),r=new RegExp(e),r.test(t)?[]:[{code:"STRING_PATTERN",path:[].concat(n)}]}function h(t,e,n){return t!==e?[{code:"CONSTANT",path:[].concat(n)}]:[]}function u(t,e){for(var n=t;"string"==typeof n&&e[n];)n=e[n];return n}function p(t,e){var n,r=u(t,e);return Array.isArray(r)?n=r.map(function(t){return p(t,e)}):f(r)?(n={},Object.keys(r).forEach(function(t){n[t]=p(r[t],e)})):n=r,n}function f(t){return null!=t&&"object"==typeof t&&!Array.isArray(t)&&t.constructor===Object}function s(){this.schemas={}}var d="\\-?(?:0|[1-9]\\d*)(?:\\.\\d+)?",l=new RegExp("^{("+d+"(,"+d+")*)}$"),R=new RegExp("^(\\[|\\()("+d+")?,("+d+")?(\\]|\\))$");return s.prototype={addSchema:function(t,e){this.schemas[t]=e},getDereferencedSchema:function(t){return p(this.schemas[t],this.schemas)},validate:function(t,e){var n,r=this,a={valid:!0,errors:[]};return r.path=["$"],n=r.validateRoot(t,e),n.length&&(a.valid=!1,a.errors=[].concat(n)),a},validateRoot:function(o,c){var i,p=this,s=p.path,d=u(c,p.schemas);return i=Array.isArray(d)?p.validateArray(o,d):f(d)?p.validateObject(o,d):"boolean"===d?t(o,s):"number"===d?n(o,s):"integer"===d?r(o,s):"string"===d?e(o,s):"string"==typeof d?a(o,d,s):h(o,d,s),i.length,i},validateArray:function(t,e){var n,r,a,o,c,i,h=this,u=[];if(!Array.isArray(t))return[{code:"ARRAY_REQUIRED",path:[].concat(h.path)}];for(o=e.length,n=0,r=t.length;n<r;n++){for(c=!1,h.path.push(n),a=0;a<o;a++)if(i=h.validateRoot(t[n],e[a]),!i.length){c=!0;break}c||(o>1?u.push({code:"ARRAY_ITEM",path:[].concat(h.path)}):u=u.concat(i)),h.path.pop()}return u},validateObject:function(t,e){var n,r,a,o,c,i,h=this,u=[],p=Object.keys(t),f=Object.keys(e),s=f.length;for(i=0;i<s;i++)r=n=f[i],o=n.match(/\?$/),o&&(r=r.replace(/\?$/,"")),a=p.indexOf(r),c=[],h.path.push(n),-1!==a||o?-1!==a&&(c=h.validateRoot(t[r],e[n]),c.length&&(u=u.concat(c)),p.splice(a,1)):u.push({code:"OBJECT_PROPERTY_REQUIRED",path:[].concat(h.path)}),h.path.pop();return p.length&&p.forEach(function(t){u.push({code:"OBJECT_PROPERTIES_ADDITIONAL",path:[].concat(h.path,t)})}),u}},s});

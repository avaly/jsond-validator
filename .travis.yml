language: node_js
node_js:
  - '6'

cache:
  yarn: true

jobs:
  include:
    - stage: test
      script: npm run lint
    - stage: test
      script: npm run test-flow
    - stage: test
      script: npm run test-client
    - stage: test-saucelabs
      script: npm run test-saucelabs
    - stage: quality
      script: npm run coverage
    - stage: quality
      script: npm run benchmark
    - stage: deploy
      deploy:
        - provider: script
          skip_cleanup: true
          script: tools/docs
          on:
            tags: true
        - provider: script
          skip_cleanup: true
          script: tools/publish
          on:
            tags: true
